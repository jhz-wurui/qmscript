[General]
SyntaxVersion=2
MacroID=1174689a-c06c-4be1-8a62-ec270a056bef
[Comment]

[Script]
//【江中游】说明注意：看我的注释进行加减，注意，3.1233及以前的版本参数guolu可选0
Sub dmzc(lujing, bbh, guolu)'参数：1、路径；2、版本号；4，三个选择0）、是否提示注册成功及路径。1）收费注册。2）解除注册
    Call Plugin.File.CreateFolder(lujing)'这个是建立文件夹，准备释放要使用的文件***路径可以修改
    PutAttachment lujing, "*.*"'释放大漠对像***路径可以修改
    PutAttachment ".\plugin", "regdll.dll"'释放注册插件到按键的插件文件夹，这个不能改
    set ws=createobject("Wscript.Shell")'插件需要用到atl系统库,有些XP精简系统会把atl.dll精简掉. 为了防止注册失败，这里手动注册一下atl.dll
    ws.run "regsvr32 atl.dll /s"
    set ws=nothing
    If guolu = 0 Then
        Call Plugin.RegDll.Reg(lujing&"\dm.dll")'注册大漠插件***路径可以修改
        Set dm = createobject("dm.dmsoft")
        If dm.Ver() <> bbh Then '判断你的插件版本是否已经注册成功，注意！！！这个是3.1249版的，其它版本自己改下号
            Set dm = nothing
            Set ws = createobject("Wscript.Shell")
            ws.run "regsvr32 "&lujing&"\dm.dll /s"'大漠插件的路径，大家自己改成自己的路径就行了！
            Set ws = nothing
            Delay 1500
        End If
        Set dm = createobject("dm.dmsoft")'大漠对像
        dm_ret = dm.SetPath(lujing)'全局路径
        If len(dm.Ver()) = 0 Then '注册成功后可删除****
            MsgBox "注册未成功，请检查您的系统是否禁用了VBS脚本权限"'注册成功后可删除****       
        End If'注册成功后可删除****
    ElseIf guolu = 1 Then
        Call Plugin.RegDll.Reg(lujing&"\dm.dll")'注册大漠插件***路径可以修改
        Set dm = createobject("dm.dmsoft")
        If dm.Ver() <> bbh Then '判断你的插件版本是否已经注册成功，注意！！！这个是3.1249版的，其它版本自己改下号
            //TracePrint "版本不对。。。。。。。。。。。。。。"
            Set dm = nothing
            Set ws = createobject("Wscript.Shell")
            ws.run "regsvr32 "&lujing&"\dm.dll /s"'大漠插件的路径，大家自己改成自己的路径就行了！
            Set ws = nothing
            Delay 1500
        End If
        //TracePrint "版本正确了。。。。。。。。。。。。。。"
        Set dm = createobject("dm.dmsoft")
        If len(dm.Ver()) = 0 Then '注册成功后可删除****
            MsgBox "注册未成功，请检查您的系统是否禁用了VBS脚本权限"'注册成功后可删除****
         
            
           
        End If'注册成功后可删除****
        dm_ret = dm.Reg("wininchinafd6ca7b4ce3f8d69b5da2a48338f14a9", "")
        If dm_ret <> 1 Then 
            MsgBox "收费注册不成功，确定后再次进行注册！"&"返回值："&dm_ret
            dm_ret = dm.RegEx("wininchinafd6ca7b4ce3f8d69b5da2a48338f14a9", "", "182.16.17.77|182.16.17.70")
            TracePrint dm_ret
            if dm_ret <> 1 then
                MessageBox "注册失败,只能使用免费功能！"&"返回值："&dm_ret
           
            End If
            
        End If
        dm_ret = dm.SetPath(lujing)'全局路径
    ElseIf guolu = 2 Then
        Plugin.RegDll.UnReg (lujing & "\dm.dll")
    End If
End Sub

//【江中游】说明注意：看我的注释进行加减，注意，3.1233及以前的版本参数guolu可选0
Sub dmzcDefault()'参数：1、路径；2、版本号；4，三个选择0）、是否提示注册成功及路径。1）收费注册。2）解除注册
    返回值 = Lib.公共库.注册大漠("3.1233","")
    If 返回值 = - 1  Then 
        MessageBox "大漠注册失败"
        EndScript 
    End If
    
    dm_ret = dm.SetPath("c:\fuzhu")

End Sub


Sub LeftClickEx(x,y,延时)
    dm.MoveTo x, y
    Delay 延时
    dm.LeftClick 
    Delay 10
End Sub


Sub LeftDoubleClickEx(x,y,延时)
    dm.MoveTo x, y
    Delay 延时
    dm.LeftDoubleClick 
End Sub


Function  __________窗口_________________()

End Function

Sub BindWindow(hwnd,display,mouse,keypad,mode)
    dm_ret = dm.BindWindow(hwnd, display, mouse, keypad, mode)
    Delay 1500
    If dm_ret = 0 Then 
        MessageBox dm.GetLastError()
    End If	
End Sub

Sub BindWindowEx(hwnd,display,mouse,keypad,pub,mode)
    dm_ret = dm.BindWindowEx(hwnd, display, mouse, keypad,pub, mode)
    Delay 1500
    If dm_ret = 0 Then 
        MessageBox dm.GetLastError()
    End If	
End Sub
