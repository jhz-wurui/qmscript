[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=b0ac03ca-b8c5-488d-8ccd-8b82b3e1d40e
Description=文件处理
Enable=0
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form1
[Relative]
SetupOCXFile=
[Comment]

[UIPackage]
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


[Script]
path = Form1.BrowseBox1.Path

Text = Plugin.File.ReadFileEx(path)

num1 = clng(Form1.InputBox1.Text)
num2 = clng(Form1.InputBox2.Text)

Dim MyArray

MyArray = Split(Text, "|")

Call Lib.ICEFRAG.文件_createFileExistDel("c:\结果.txt")

If UBound(MyArray) >= 0 Then 
	i=0
	Do
		data = Cstr(MyArray(i))
		TracePrint data
		If instr(data, "发票名称") <> 0 Then 
			金额 = clng(replace(MyArray(i + 6),"价税合计金额(元)：",""))
			TracePrint 金额		 
			If 金额 >= num1 and 金额 <= num2 Then 
				TracePrint "符合要求的金额:" & 金额
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i+1)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i+2)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i+3)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i+4)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i+5)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i+6)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i + 7)))
				Call Plugin.File.WriteFileEx("c:\结果.txt", Cstr(MyArray(i + 8)))
				Call Plugin.File.WriteFileEx("c:\结果.txt","")
			End If
			i = i + 9
		Else 
			i = i + 1
			Form1.ProgressBar1.Value = cint((i/UBound(MyArray))*100)
		End If
		
		If i >= UBound(MyArray) Then 
			Form1.ProgressBar1.Value = 100
			MessageBox "处理完毕!"
			RunApp "c:\结果.txt"
			EndScript 
		End If
	Loop
End If

Event Form1.LoadOver
	Form1.ProgressBar1.Value = 0
End Event
